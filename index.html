<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>צ'אט GPT עם Puter</title>
    <script src="https://js.puter.com/v2/"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #f7f9fc;
            direction: rtl;
            text-align: right;
            padding: 20px;
        }
        .container {
            max-width: 600px;
            margin: auto;
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        h2 {
            text-align: center;
        }
        #messages {
            min-height: 200px;
            border: 1px solid #ddd;
            padding: 10px;
            margin-bottom: 10px;
            white-space: pre-wrap;
        }
        #response {
            margin-top: 10px;
            color: green;
        }
        select, button, input {
            padding: 10px;
            margin: 5px 0;
            width: 100%;
            box-sizing: border-box;
        }
        #userInfo {
            font-size: 0.9em;
            margin-bottom: 10px;
            color: #333;
        }
        .buttons {
            display: flex;
            gap: 10px;
        }
        .buttons button {
            flex: 1;
        }
    </style>
</head>
<body>
    <div class="container">
        <h2>צ'אט GPT עם Puter</h2>
        <div id="userInfo">🔒 לא מחובר</div>

        <div class="buttons">
            <button onclick="signIn()">🔑 התחבר</button>
            <button onclick="signOut()">🚪 התנתק</button>
        </div>

        <label for="model">בחר מודל:</label>
        <select id="model">
            <option value="gpt-4o-mini">gpt-4o-mini</option>
            <option value="gpt-4o">gpt-4o</option>
            <option value="gpt-4.1-nano">gpt-4.1-nano</option>
            <option value="gpt-4.5-preview">gpt-4.5-preview</option>
            <option value="claude-3-7-sonnet">claude-3-7-sonnet</option>
            <option value="deepseek-chat">deepseek-chat</option>
            <option value="meta-llama/Meta-Llama-3.1-8B-Instruct-Turbo">LLaMA 3.1 8B</option>
            <option value="meta-llama/Meta-Llama-3.1-70B-Instruct-Turbo">LLaMA 3.1 70B</option>
        </select>

        <div id="messages"></div>
        <input type="text" id="userInput" placeholder="הקלד שאלה...">
        <button onclick="sendMessage()">שלח</button>

        <div id="response"></div>
    </div>

    <script>
        async function signIn() {
            try {
                await puter.auth.signIn();
                updateUserInfo();
            } catch (error) {
                alert('שגיאה בהתחברות: ' + error.message);
            }
        }

        async function signOut() {
            await puter.auth.signOut();
            updateUserInfo();
        }

        async function updateUserInfo() {
            const user = await puter.auth.getUser();
            if (user) {
                document.getElementById("userInfo").innerText = `👤 מחובר בתור: ${user.name || user.username || user.email}`;
            } else {
                document.getElementById("userInfo").innerText = "🔒 לא מחובר";
            }
        }

        async function sendMessage() {
            const input = document.getElementById("userInput").value.trim();
            const model = document.getElementById("model").value;
            const messagesDiv = document.getElementById("messages");
            if (!input) return;

            messagesDiv.innerHTML += `👤 אתה: ${input}\n`;
            document.getElementById("userInput").value = "ממתין לתשובה...";

            try {
                const response = await puter.ai.chat(input, { model });
                const reply = response.message?.content || '[ללא תגובה]';
                messagesDiv.innerHTML += `🤖 GPT: ${reply}\n\n`;
            } catch (error) {
                messagesDiv.innerHTML += `⚠️ שגיאה: ${error.message}\n\n`;
            }

            document.getElementById("userInput").value = "";
        }

        // בדיקת התחברות בהתחלה
        updateUserInfo();
    </script>
</body>
</html>
